<!-- WIGGERPIG / ABYSS LOADING SCREEN -->
<div id="abyss-loader" class="abyss-loader-screen">
  <div class="preload">
    <span class="preload__letter">A</span>
    <span class="preload__letter">B</span>
    <span class="preload__letter">Y</span>
    <span class="preload__letter">S</span>
    <span class="preload__letter">S</span>
  </div>
</div>

<!-- ABYSS TOP BAR -->
<header class="abyss-nav">
  <div class="abyss-nav-inner">
    <div class="abyss-brand">
      <span class="brand-pill">WiggerPig</span>
      <span class="brand-sub">Abyss.tv</span>
    </div>
    <nav class="abyss-nav-links">
      <a href="/" class="nav-link">Home</a>
      <a href="#abyss-tv" class="nav-link">Stream</a>
      <a href="https://discord.gg/abyssvc" target="_blank" class="nav-link">Discord</a>
    </nav>
  </div>
</header>

<!-- ABYSS.TV – STREAM + EVENTS + VODS -->
<section id="abyss-tv">
  <div class="abyss-shell">

    <!-- HEADER + LIVE + CTA -->
    <header class="abyss-top card">
      <div class="abyss-top-left">
        <h2 class="abyss-title">ABYSS LIVE</h2>
        <p class="abyss-sub">
          Nightmare-grade streams, cursed gameshows and emotional damage in HD.
        </p>

        <div class="abyss-meta-row">
          <span id="abyss-live-pill" class="abyss-live-pill">
            <span class="dot"></span>
            LIVE
          </span>
          <a href="https://kick.com/abyssdiscord" target="_blank" class="abyss-link">
            Watch on Kick ↗
          </a>
        </div>
      </div>

      <div class="abyss-top-right">
        <a href="https://discord.gg/abyssvc" target="_blank" class="abyss-cta">
          Join the Abyss Discord
          <span class="abyss-cta-sub">discord.gg/abyssvc</span>
        </a>
      </div>
    </header>

    <!-- STREAM PLAYER -->
    <div class="abyss-player-wrap card">
      <div class="abyss-glow"></div>
      <div class="abyss-aspect">
        <iframe
          src="https://player.kick.com/abyssdiscord?autoplay=true&muted=false"
          allowfullscreen="true"
          frameborder="0"
          scrolling="no"
          loading="lazy"
          title="Abyss Live Stream"
        ></iframe>
      </div>
      <div class="abyss-noise-layer"></div>
    </div>

    <!-- CONTENT GRID: EVENTS + VODS -->
    <div class="abyss-main-grid">
      <!-- UPCOMING EVENTS -->
      <section class="abyss-block card">
        <div class="abyss-block-head">
          <h3>Upcoming Events</h3>
          <span class="block-tag">Schedule</span>
        </div>
        <div id="abyss-events-list" class="abyss-events-list"></div>
        <p id="abyss-no-events" class="abyss-empty">
          No scheduled chaos. Follow on Kick & Discord for surprise streams.
        </p>
      </section>

      <!-- VODS / HIGHLIGHTS -->
      <section class="abyss-block card">
        <div class="abyss-block-head">
          <h3>Vods & Highlights</h3>
          <span class="block-tag">Archive</span>
        </div>
        <div id="abyss-vods-grid" class="abyss-vods-grid"></div>
        <p class="abyss-empty abyss-vods-foot">
          Full archive lives on
          <a href="https://kick.com/abyssdiscord/videos" target="_blank" class="abyss-link">
            Kick vods ↗
          </a>
        </p>
      </section>
    </div>

  </div>
</section>

<style>
  :root {
    --abyss-bg: #020308;
    --abyss-panel: #05050a;
    --abyss-border: rgba(255,255,255,0.1);
    --abyss-text: #f5f5f5;
    --abyss-muted: #a0a0a0;
  }

  body {
    background: #000;
    color: var(--abyss-text);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  }

  /* ====== LOADING SCREEN ====== */
  .abyss-loader-screen {
    position: fixed;
    inset: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 99999;
    overflow: hidden;
    transition: opacity .6s ease, visibility .6s ease;
  }
  .abyss-loader-screen.hide {
    opacity: 0;
    visibility: hidden;
  }
  .preload {
    font-size: 5rem;
    line-height: 5rem;
    font-family: "Roboto Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    color: #fff;
    text-align: center;
    display: inline-block;
  }
  .preload__letter {
    display: inline-block;
    margin: 0 .25em;
    position: relative;
  }
  .preload__letter--loaded::after {
    content: '•';
    width: 100%;
    text-align: center;
    position: absolute;
    top: 100%;
    left: 0;
    color: #fff;
    font-size: 2.6rem;
    line-height: 2.6rem;
  }
  body.loading {
    overflow: hidden;
  }

  /* ====== TOP NAV ====== */
  .abyss-nav {
    position: sticky;
    top: 0;
    z-index: 20;
    backdrop-filter: blur(12px);
    background: linear-gradient(to bottom, rgba(0,0,0,0.9), rgba(0,0,0,0.6));
    border-bottom: 1px solid rgba(255,255,255,0.06);
  }
  .abyss-nav-inner {
    max-width: 1280px;
    margin: 0 auto;
    padding: 0.6rem 1.5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1.5rem;
  }
  .abyss-brand {
    display: flex;
    align-items: baseline;
    gap: 0.5rem;
  }
  .brand-pill {
    padding: 0.2rem 0.7rem;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.3);
    font-size: 0.8rem;
    letter-spacing: 0.16em;
    text-transform: uppercase;
  }
  .brand-sub {
    font-size: 0.85rem;
    color: var(--abyss-muted);
    text-transform: uppercase;
    letter-spacing: 0.18em;
  }
  .abyss-nav-links {
    display: flex;
    gap: 1.2rem;
    flex-wrap: wrap;
  }
  .nav-link {
    font-size: 0.85rem;
    text-decoration: none;
    color: var(--abyss-muted);
    text-transform: uppercase;
    letter-spacing: 0.14em;
  }
  .nav-link:hover {
    color: #fff;
  }

  /* ====== LAYOUT ====== */
  #abyss-tv {
    background: radial-gradient(circle at top, #0b0b12 0, #020308 40%, #000 100%);
    padding: 3.2rem 1.5rem 4rem;
    position: relative;
    overflow: hidden;
  }
  #abyss-tv::before {
    content: "";
    position: absolute;
    inset: -40%;
    background:
      radial-gradient(circle at 10% 0%, rgba(255,255,255,0.06) 0, transparent 55%),
      radial-gradient(circle at 90% 100%, rgba(255,255,255,0.04) 0, transparent 50%);
    mix-blend-mode: screen;
    opacity: 0.2;
    pointer-events: none;
  }
  .abyss-shell {
    max-width: 1280px;
    margin: 0 auto;
    position: relative;
    z-index: 1;
  }

  .card {
    border-radius: 1.1rem;
    border: 1px solid var(--abyss-border);
    background: radial-gradient(circle at top left, rgba(255,255,255,0.04), rgba(0,0,0,0.95));
    box-shadow: 0 22px 60px rgba(0,0,0,0.8);
  }

  .abyss-top {
    display: flex;
    justify-content: space-between;
    gap: 2rem;
    padding: 1.3rem 1.5rem;
    margin-bottom: 1.6rem;
  }

  .abyss-title {
    font-size: 2.1rem;
    letter-spacing: 0.22em;
    text-transform: uppercase;
    margin-bottom: 0.35rem;
  }
  .abyss-sub {
    font-size: 0.95rem;
    color: var(--abyss-muted);
    max-width: 30rem;
    line-height: 1.5;
  }
  .abyss-meta-row {
    display: flex;
    align-items: center;
    gap: 0.9rem;
    margin-top: 0.9rem;
    flex-wrap: wrap;
  }
  .abyss-live-pill {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.25rem 0.8rem;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.18);
    font-size: 0.7rem;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    background: rgba(0,0,0,0.8);
  }
  .abyss-live-pill .dot {
    width: 0.5rem;
    height: 0.5rem;
    border-radius: 999px;
    background: #ff2b2b;
    box-shadow: 0 0 10px rgba(255,43,43,0.9);
    animation: abyss-pulse 1.3s infinite ease-in-out;
  }
  @keyframes abyss-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(0.7); opacity: 0.4; }
  }
  .abyss-link {
    font-size: 0.8rem;
    text-decoration: none;
    color: var(--abyss-text);
    opacity: 0.85;
    border-bottom: 1px solid rgba(255,255,255,0.24);
    padding-bottom: 1px;
  }
  .abyss-link:hover {
    opacity: 1;
  }

  .abyss-top-right {
    display: flex;
    justify-content: flex-end;
    flex: 1;
  }
  .abyss-cta {
    display: inline-flex;
    flex-direction: column;
    gap: 0.2rem;
    padding: 0.85rem 1.3rem;
    border-radius: 0.9rem;
    border: 1px solid rgba(255,255,255,0.25);
    text-decoration: none;
    color: var(--abyss-text);
    background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(0,0,0,0.95));
    font-size: 0.85rem;
    text-align: right;
  }
  .abyss-cta-sub {
    font-size: 0.75rem;
    color: var(--abyss-muted);
  }

  .abyss-player-wrap {
    position: relative;
    overflow: hidden;
    background: #000;
    margin-bottom: 2rem;
    padding: 0.8rem;
  }
  .abyss-glow {
    position: absolute;
    inset: -30%;
    background: radial-gradient(circle at 50% 0%, rgba(255,255,255,0.18) 0, transparent 55%);
    mix-blend-mode: screen;
    opacity: 0.16;
    pointer-events: none;
  }
  .abyss-aspect {
    position: relative;
    width: 100%;
    padding-top: 56.25%; /* 16:9 */
    isolation: isolate;
    border-radius: 0.8rem;
    overflow: hidden;
  }
  .abyss-aspect iframe {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
  }
  .abyss-noise-layer {
    position: absolute;
    inset: 0;
    opacity: 0.13;
    mix-blend-mode: soft-light;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 1200 800' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.2' numOctaves='4' stitchTiles='noStitch'/%3E%3C/filter%3E%3Crect width='120%' height='120%' filter='url(%23n)' opacity='0.6'/%3E%3C/svg%3E");
    pointer-events: none;
  }

  .abyss-main-grid {
    display: grid;
    grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.1fr);
    gap: 1.5rem;
  }

  .abyss-block {
    padding: 1.2rem 1.3rem 1.4rem;
  }
  .abyss-block-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
    margin-bottom: 0.9rem;
  }
  .abyss-block-head h3 {
    font-size: 0.95rem;
    letter-spacing: 0.16em;
    text-transform: uppercase;
  }
  .block-tag {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.18em;
    padding: 0.2rem 0.7rem;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.25);
  }

  .abyss-events-list {
    display: flex;
    flex-direction: column;
    gap: 0.7rem;
  }
  .abyss-event {
    padding: 0.75rem 0.8rem;
    border-radius: 0.7rem;
    border: 1px solid rgba(255,255,255,0.1);
    background: rgba(0,0,0,0.7);
  }
  .abyss-event-title {
    font-size: 0.9rem;
    margin-bottom: 0.2rem;
  }
  .abyss-event-meta {
    font-size: 0.75rem;
    color: var(--abyss-muted);
    display: flex;
    gap: 0.4rem;
    flex-wrap: wrap;
  }
  .abyss-event-desc {
    margin-top: 0.4rem;
    font-size: 0.82rem;
    color: rgba(245,245,245,0.92);
  }

  .abyss-empty {
    font-size: 0.8rem;
    color: var(--abyss-muted);
    margin-top: 0.9rem;
  }
  .abyss-vods-foot {
    margin-top: 1.1rem;
  }

  /* VODS GRID */
  .abyss-vods-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1rem;
  }
  .abyss-vod-card {
    background: rgba(0,0,0,0.9);
    border-radius: 0.9rem;
    border: 1px solid rgba(255,255,255,0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    min-height: 0;
  }
  .abyss-vod-thumb-wrap {
    position: relative;
    width: 100%;
    padding-top: 56.25%;
    background: #050505;
    overflow: hidden;
    cursor: pointer;
  }
  .abyss-vod-thumb {
    position: absolute;
    inset: 0;
    background-size: cover;
    background-position: center;
    filter: grayscale(100%);
    transform: scale(1.03);
    transition: transform 0.3s ease, filter 0.3s ease, opacity 0.3s ease;
    opacity: 0.9;
  }
  .abyss-vod-play {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
  }
  .abyss-vod-play::before {
    content: "";
    width: 2.4rem;
    height: 2.4rem;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.7);
    background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.4), rgba(0,0,0,0.95));
    box-shadow: 0 0 18px rgba(0,0,0,0.9);
  }
  .abyss-vod-play::after {
    content: "";
    position: absolute;
    margin-left: 0.06rem;
    width: 0;
    height: 0;
    border-left: 0.8rem solid #fff;
    border-top: 0.5rem solid transparent;
    border-bottom: 0.5rem solid transparent;
  }
  .abyss-vod-thumb-wrap:hover .abyss-vod-thumb {
    transform: scale(1.06);
    filter: grayscale(10%);
    opacity: 1;
  }
  .abyss-vod-body {
    padding: 0.75rem 0.9rem 0.9rem;
  }
  .abyss-vod-title {
    font-size: 0.9rem;
    margin-bottom: 0.2rem;
  }
  .abyss-vod-meta {
    font-size: 0.75rem;
    color: var(--abyss-muted);
  }

  @media (max-width: 900px) {
    .abyss-main-grid {
      grid-template-columns: minmax(0,1fr);
    }
  }

  @media (max-width: 820px) {
    .abyss-top {
      flex-direction: column;
      align-items: flex-start;
    }
    .abyss-top-right {
      width: 100%;
    }
    .abyss-cta {
      width: 100%;
      text-align: left;
    }
  }

  @media (max-width: 640px) {
    #abyss-tv {
      padding: 2.4rem 1rem 3rem;
    }
    .preload {
      font-size: 3.4rem;
      line-height: 3.4rem;
    }
  }
</style>

<script>
  // ================================
  //  LOADER: ABYSS TEXT SCRAMBLE
  // ================================
  document.body.classList.add("loading");

  const abyssLoader = document.getElementById("abyss-loader");
  const letters = document.querySelectorAll(".preload__letter");

  const TARGET_TEXT = "ABYSS".toUpperCase().split("");
  const POSSIBLE = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
  let intervals = [];

  function randomizeLetter(el, index) {
    intervals[index] = setInterval(() => {
      el.textContent = POSSIBLE.charAt(Math.floor(Math.random() * POSSIBLE.length));
    }, 50);

    setTimeout(() => {
      clearInterval(intervals[index]);
      el.textContent = TARGET_TEXT[index];
      el.classList.add("preload__letter--loaded");
    }, 250 * index);
  }

  function startAbyssLoader() {
    TARGET_TEXT.forEach((_, i) => randomizeLetter(letters[i], i));

    const doneTime = 250 * TARGET_TEXT.length + 500;

    setTimeout(() => {
      abyssLoader.classList.add("hide");
      document.body.classList.remove("loading");
    }, doneTime);
  }

  startAbyssLoader();

  // ================================
  //  STREAM / EVENTS / VODS LOGIC
  // ================================
  const ABYSS_IS_LIVE = false; // set false when offline

  const abyssEvents = [
    {
      title: "Femboy Jeopardy: Cupid Redemption Arc",
      date: "2025-11-22T21:00:00",
      type: "Gameshow",
      desc: "Double points, double pain. Hermes answers instantly banned.",
      link: "https://kick.com/abyssdiscord"
    },
    {
      title: "Cursed Catchphrase: Mr Chips vs WiggerPig",
      date: "2025-11-29T20:30:00",
      type: "Event",
      desc: "Say what you see. If what you see is trauma, that’s on you.",
      link: "https://kick.com/abyssdiscord"
    }
    // add more events if you want
  ];

  // VODs: works with YouTube OR Kick links
  const abyssVods = [
    {
      title: "Femboy Jeopardy",
      meta: "Gameshow · 1h 12m",
      link: "https://kick.com/abyssdiscord/videos/18cd356c-e0f9-4b9a-8b6c-7b0ea1a66eb1",
      thumb: "https://cdn.discordapp.com/attachments/1307052661358727281/1439684031154360360/image.png?ex=691b69bd&is=691a183d&hm=8a3ce11bc05da2e259672db49992ef6a20242da25579145ec0550d31244a9aba&"
    },
    {
      title: "Abyss VC Meltdown #1",
      meta: "Highlights · 9m 40s",
      link: "https://www.youtube.com/watch?v=YOUR_VIDEO_ID",
      thumb: "https://YOUR_THUMB_URL_2.jpg"
    },
    {
      title: "WiggerPig Lore Stream – The Dawn",
      meta: "Lore · 48m",
      link: "https://kick.com/video/YOUR_VOD_OR_YT_LINK_3",
      thumb: "https://YOUR_THUMB_URL_3.jpg"
    }
    // add more, grid will keep filling down in rows of 3-ish
  ];

  function formatEventDate(dateStr) {
    const d = new Date(dateStr);
    return d.toLocaleString(undefined, {
      weekday: "short",
      day: "numeric",
      month: "short",
      hour: "2-digit",
      minute: "2-digit"
    });
  }

  (function initAbyssTV() {
    // LIVE badge
    const livePill = document.getElementById("abyss-live-pill");
    if (livePill && !ABYSS_IS_LIVE) {
      livePill.style.opacity = "0.35";
      livePill.innerHTML = "OFFLINE";
    }

    // EVENTS
    const eventsList = document.getElementById("abyss-events-list");
    const noEvents = document.getElementById("abyss-no-events");
    if (eventsList) {
      const now = new Date();
      const upcoming = abyssEvents
        .filter(e => new Date(e.date) >= now)
        .sort((a,b) => new Date(a.date) - new Date(b.date));

      if (!upcoming.length) {
        noEvents && (noEvents.style.display = "block");
      } else {
        noEvents && (noEvents.style.display = "none");
        upcoming.forEach(ev => {
          const card = document.createElement("article");
          card.className = "abyss-event";
          card.innerHTML = `
            <div class="abyss-event-title">${ev.title}</div>
            <div class="abyss-event-meta">
              <span>${formatEventDate(ev.date)}</span>
              <span>• ${ev.type}</span>
            </div>
            <p class="abyss-event-desc">${ev.desc}</p>
          `;
          if (ev.link) {
            card.style.cursor = "pointer";
            card.addEventListener("click", () => window.open(ev.link, "_blank"));
          }
          eventsList.appendChild(card);
        });
      }
    }

    // VODS – thumbnails only, click → open new tab
    const vodGrid = document.getElementById("abyss-vods-grid");
    if (vodGrid) {
      abyssVods.forEach(v => {
        const card = document.createElement("article");
        card.className = "abyss-vod-card";

        const thumbWrap = document.createElement("div");
        thumbWrap.className = "abyss-vod-thumb-wrap";

        const thumb = document.createElement("div");
        thumb.className = "abyss-vod-thumb";
        if (v.thumb) {
          thumb.style.backgroundImage = `url('${v.thumb}')`;
        }

        const playOverlay = document.createElement("div");
        playOverlay.className = "abyss-vod-play";

        thumbWrap.appendChild(thumb);
        thumbWrap.appendChild(playOverlay);

        thumbWrap.addEventListener("click", () => {
          window.open(v.link, "_blank");
        });

        const body = document.createElement("div");
        body.className = "abyss-vod-body";
        body.innerHTML = `
          <div class="abyss-vod-title">${v.title}</div>
          <div class="abyss-vod-meta">${v.meta}</div>
        `;

        card.appendChild(thumbWrap);
        card.appendChild(body);
        vodGrid.appendChild(card);
      });
    }
  })();
</script>
